---
title: 利用Rand7实现Rand10
date: 2020-09-05 14:42:38
categories:
- C++
---

## 一、简述
* 以下是`https://leetcode.com/problems/implement-rand10-using-rand7/solution/`上的解答

## 二、Intuition
* 如果我们知道如何从生成1-49中的随机数，我们是不是就可以生成1-10之间的随机数了。那我们就要考虑，如果生成的随机数在可用范围（可以映射到1-10的范围）内，或者不在该范围内，我们需要做什么。

<!-- more -->
## 三、Algorithm
* 该算法是基于`Rejection Sampling`来做的。主要的思想是，如果在可用范围内，直接输出该数值对应的目标数值，如果不在该范围内，不采用该数值，重新进行随机。
* 由于所有在可用范围内的数值被取到的概率是相等的，因此最后的目标数值也是满足均匀分布的。
* 由于只调用一次`rand7`生成的随机数范围是1-7，不够映射1-10这么多数值。因此我们可以调用2次`rand7`来获得如下的一个1-49的均匀分布：
![均匀分布](rand7rand10.png)
* 结题过程：调用`rand7`2次，对应于上述方阵中的行(列)，从而获得一个方阵中的坐标。如果是在1-40内，立即返回映射到1-10内的随机数；否则，重新通过`rand7`随机。
* 代码：
``` cpp
class Solution
{
   public:
    uint32_t rand10() {
        int row, col, idx;
        do {
            row = rand7();
            col = rand7();
            idx = col + (row - 1) * 7;
        } while (idx > 40);
        return 1 + (idx - 1) % 10;
    }
};
```

## 四、复杂度分析
* 平均复杂度: $$O(1)$$，但是最坏的复杂度是O(无限)
* ![调用rand7平均次数](callstorand7.png)
* 上述计算中，第一个分项: `40/49`的概率调用了两次`rand7`，表示一次运算就`idx`在1-40中，第二个分项：表示第一次运算`idx`在41-49中，第二次运算才命中1-40...

